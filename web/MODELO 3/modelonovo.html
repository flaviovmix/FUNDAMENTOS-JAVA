<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <title>To-Do — Estático</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>

  <main class="boards">

    <section class="board">
      <ul class="lista-tarefas">


        <li class="todo" data-prio="baixa">
          <div class="todo-wrapper">
            <!-- CONTEÚDO PRINCIPAL (o card que desliza) -->
            <a href="www.google.com" class="todo-link">
              <div class="content">
                <div class="t-titulo">Revisar notas antigas</div>

                <div class="t-responsavel">
                  <span class="label-res">Resp.: </span>Flávio José dos Passos
                </div>

                <div class="t-data">
                  <span><i class="fa-solid fa-calendar-alt"></i></span> Quarta-feira - 12 jan. 2025
                </div>
                <div class="selecaoAtivoInativo">
                  <label class="toggle"><input type="checkbox" checked>
                    <span class="slider"></span>
                  </label>
                </div>
                <div class="meta">
                  <div class="detalhes-tarefa">
                    <span class="badge quant-subtarefas">3 subtarefas</span>
                    <span class="badge quant-subtarefas"> #11</span>
                  </div>
                </div>
              </div>


              <p style="text-align:center;">Organizar anotaçõa é útil.</p>
            </a>

            <!-- AÇÕES REVELADAS NO SWIPE -->
            <div class="actions-wrapper">
              <!-- LINHA DE CIMA (3 botões) -->
              <div class="todo-actions linha-topo">
                <button class="btn-action btn-edit" onclick="alert('Clique no botao!')">
                  <i class="fa-solid fa-pen-to-square"></i>
                </button>

                <button class="btn-action btn-middle" onclick="alert('Clique no botao!')">
                  <i class="fa-solid fa-star"></i>
                </button>

                <button class="btn-action btn-delete" onclick="alert('Clique no botao!')">
                  <i class="fa-solid fa-trash"></i>
                </button>
              </div>

              <!-- LINHA DE BAIXO (3 botões) -->
              <div class="todo-actions linha-bottom">
                <button class="btn-action btn-edit" onclick="alert('Clique no botao!')">
                  <i class="fa-solid fa-pen-to-square"></i>
                </button>

                <button class="btn-action btn-middle" onclick="alert('Clique no botao!')">
                  <i class="fa-solid fa-star"></i>
                </button>

                <button class="btn-action btn-delete" onclick="alert('Clique no botao!')">
                  <i class="fa-solid fa-trash"></i>
                </button>
              </div>
            </div>
            <button class="trash-btn" onclick="excluirTarefa(101)">
              <a href="lixeira" class="link-lixeira"><i class="fa-solid fa-trash"></i></a>
            </button>

          </div>
        </li>

      </ul>
    </section>
  </main>

<script>
  (function () {
    const todos = document.querySelectorAll('.todo');

    let startX = 0;
    let currentX = 0;
    let isDragging = false;
    let activeTodo = null;
    const threshold = 60;      // quanto precisa arrastar para "abrir" as ações
    const swipeDetect = 8;     // a partir de quantos px considero que NÃO é clique

    todos.forEach(todo => {
      const link = todo.querySelector('.todo-link');

      link.addEventListener('touchstart', handleStart, { passive: true });
      link.addEventListener('touchmove', handleMove, { passive: false });
      link.addEventListener('touchend', handleEnd);
    });

    function handleStart(e) {
      const touch = e.touches[0];
      startX = touch.clientX;
      currentX = startX;
      isDragging = true;
      activeTodo = this.closest('.todo');

      // Se outro item estiver aberto, fecha
      document.querySelectorAll('.todo.show-actions').forEach(t => {
        if (t !== activeTodo) t.classList.remove('show-actions');
      });
    }

    function handleMove(e) {
      if (!isDragging || !activeTodo) return;

      const touch = e.touches[0];
      currentX = touch.clientX;
      const deltaX = currentX - startX;

      // Só nos interessa arrastar para a esquerda
      if (deltaX < 0) {
        e.preventDefault(); // evita scroll vertical enquanto arrasta
        const link = activeTodo.querySelector('.todo-link');
        const maxSlide = -120;
        const translateX = Math.max(deltaX, maxSlide);
        link.style.transform = `translateX(${translateX}px)`;
      }
    }

    function handleEnd(e) {
      if (!isDragging || !activeTodo) return;

      const deltaX = currentX - startX;
      const link = activeTodo.querySelector('.todo-link');

      const isSwipe = Math.abs(deltaX) > swipeDetect;

      // Se foi swipe, CANCELA o click que acionaria o checkbox
      if (isSwipe) {
        e.preventDefault();
      }

      // Se arrastou mais que o limite, mantém aberto
      if (deltaX < -threshold) {
        activeTodo.classList.add('show-actions');
        link.style.transform = ''; // deixa o CSS da classe cuidar
      } else {
        // volta pro lugar
        activeTodo.classList.remove('show-actions');
        link.style.transform = 'translateX(0)';
      }

      isDragging = false;
      activeTodo = null;
    }

    // Fechar ao tocar em qualquer lugar do documento
    document.addEventListener('touchstart', function (e) {
      const insideTodo = e.target.closest('.todo');
      if (!insideTodo) {
        document.querySelectorAll('.todo.show-actions')
          .forEach(t => t.classList.remove('show-actions'));
      }
    }, { passive: true });
  })();
</script>


</body>

</html>